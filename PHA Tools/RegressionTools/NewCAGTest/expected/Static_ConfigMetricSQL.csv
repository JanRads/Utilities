MetricKey,DenSQLBootstrap,NumSQLBootstrap,DenSQLOnGoing,NumSQLOnGoing1," select 1 as metricId, id_Patient, date_YearMonth from  [dbmSemanticAnalytics].[Fact].[BuildingBlocks]  where BuildingBlockId = 3"," (  select 1 as metricId, id_Patient, date_YearMonth from  [dbmSemanticAnalytics].[Fact].[BuildingBlocks]  where BuildingBlockId = 3 union  select 1 as metricId, id_Patient, date_YearMonth from  [dbmSemanticAnalytics].[Fact].[BuildingBlocks]  where BuildingBlockId = 4 )  intersect  select 1 as metricId, id_Patient, date_YearMonth from  [dbmSemanticAnalytics].[Fact].[BuildingBlocks]  where BuildingBlockId <> 2"," select 1 as metricId, id_Patient, date_YearMonth from  [dbmSemanticAnalytics].[Fact].[BuildingBlocks]  as q
      where BuildingBlockId = 3 and exists (select * from [dbmSemanticAnalyticsSTG].[STG].[NewMetric] a where a.[PatientKey] = q.id_Patient and a.[MetricKey] = 1)"," (  select 1 as metricId, id_Patient, date_YearMonth from  [dbmSemanticAnalytics].[Fact].[BuildingBlocks]  as q
      where BuildingBlockId = 3 and exists (select * from [dbmSemanticAnalyticsSTG].[STG].[NewMetric] a where a.[PatientKey] = q.id_Patient and a.[MetricKey] = 1) union  select 1 as metricId, id_Patient, date_YearMonth from  [dbmSemanticAnalytics].[Fact].[BuildingBlocks]  as q
      where BuildingBlockId = 4 and exists (select * from [dbmSemanticAnalyticsSTG].[STG].[NewMetric] a where a.[PatientKey] = q.id_Patient and a.[MetricKey] = 1) )  intersect  select 1 as metricId, id_Patient, date_YearMonth from  [dbmSemanticAnalytics].[Fact].[BuildingBlocks]  as q     
      where BuildingBlockId <> 2 and exists (select * from [dbmSemanticAnalyticsSTG].[STG].[NewMetric] a where a.[PatientKey] = q.id_Patient and a.[MetricKey] = 1)"2," select 2 as metricId, id_Patient, date_YearMonth from  [dbmSemanticAnalytics].[Fact].[BuildingBlocks]  where BuildingBlockId = 3 union  select 2 as metricId, id_Patient, date_YearMonth from  [dbmSemanticAnalytics].[Fact].[BuildingBlocks]  where BuildingBlockId = 1"," (  select 2 as metricId, id_Patient, date_YearMonth from  [dbmSemanticAnalytics].[Fact].[BuildingBlocks]  where BuildingBlockId = 3 union  select 2 as metricId, id_Patient, date_YearMonth from  [dbmSemanticAnalytics].[Fact].[BuildingBlocks]  where BuildingBlockId = 1 )  Except  select 2 as metricId, id_Patient, date_YearMonth from  [dbmSemanticAnalytics].[Fact].[BuildingBlocks]  where BuildingBlockId = 2"," select 2 as metricId, id_Patient, date_YearMonth from  [dbmSemanticAnalytics].[Fact].[BuildingBlocks]  as q
      where BuildingBlockId = 3 and exists (select * from [dbmSemanticAnalyticsSTG].[STG].[NewMetric] a where a.[PatientKey] = q.id_Patient and a.[MetricKey] = 2) union  select 2 as metricId, id_Patient, date_YearMonth from  [dbmSemanticAnalytics].[Fact].[BuildingBlocks]  as q
      where BuildingBlockId = 1 and exists (select * from [dbmSemanticAnalyticsSTG].[STG].[NewMetric] a where a.[PatientKey] = q.id_Patient and a.[MetricKey] = 2)"," (  select 2 as metricId, id_Patient, date_YearMonth from  [dbmSemanticAnalytics].[Fact].[BuildingBlocks]  as q
      where BuildingBlockId = 3 and exists (select * from [dbmSemanticAnalyticsSTG].[STG].[NewMetric] a where a.[PatientKey] = q.id_Patient and a.[MetricKey] = 2) union  select 2 as metricId, id_Patient, date_YearMonth from  [dbmSemanticAnalytics].[Fact].[BuildingBlocks]  as q
      where BuildingBlockId = 1 and exists (select * from [dbmSemanticAnalyticsSTG].[STG].[NewMetric] a where a.[PatientKey] = q.id_Patient and a.[MetricKey] = 2) )  Except  select 2 as metricId, id_Patient, date_YearMonth from  [dbmSemanticAnalytics].[Fact].[BuildingBlocks]  as q
      where BuildingBlockId = 2 and exists (select * from [dbmSemanticAnalyticsSTG].[STG].[NewMetric] a where a.[PatientKey] = q.id_Patient and a.[MetricKey] = 2)"3," select 3 as metricId, id_Patient, date_YearMonth from  [dbmSemanticAnalytics].[Fact].[BuildingBlocks]  where BuildingBlockId = 4 union  select 3 as metricId, id_Patient, date_YearMonth from  [dbmSemanticAnalytics].[Fact].[BuildingBlocks]  where BuildingBlockId = 2 union  select 3 as metricId, id_Patient, date_YearMonth from  [dbmSemanticAnalytics].[Fact].[BuildingBlocks]  where BuildingBlockId = 3 union  select 3 as metricId, id_Patient, date_YearMonth from  [dbmSemanticAnalytics].[Fact].[BuildingBlocks]  where BuildingBlockId = 1"," select 3 as metricId, id_Patient, date_YearMonth from  [dbmSemanticAnalytics].[Fact].[BuildingBlocks]  where BuildingBlockId = 1 intersect  select 3 as metricId, id_Patient, date_YearMonth from  [dbmSemanticAnalytics].[Fact].[BuildingBlocks]  where BuildingBlockId = 2"," select 3 as metricId, id_Patient, date_YearMonth from  [dbmSemanticAnalytics].[Fact].[BuildingBlocks]  as q
      where BuildingBlockId = 4 and exists (select * from [dbmSemanticAnalyticsSTG].[STG].[NewMetric] a where a.[PatientKey] = q.id_Patient and a.[MetricKey] = 3) union  select 3 as metricId, id_Patient, date_YearMonth from  [dbmSemanticAnalytics].[Fact].[BuildingBlocks]  as q
      where BuildingBlockId = 2 and exists (select * from [dbmSemanticAnalyticsSTG].[STG].[NewMetric] a where a.[PatientKey] = q.id_Patient and a.[MetricKey] = 3) union  select 3 as metricId, id_Patient, date_YearMonth from  [dbmSemanticAnalytics].[Fact].[BuildingBlocks]  as q
      where BuildingBlockId = 3 and exists (select * from [dbmSemanticAnalyticsSTG].[STG].[NewMetric] a where a.[PatientKey] = q.id_Patient and a.[MetricKey] = 3) union  select 3 as metricId, id_Patient, date_YearMonth from  [dbmSemanticAnalytics].[Fact].[BuildingBlocks]  as q
      where BuildingBlockId = 1 and exists (select * from [dbmSemanticAnalyticsSTG].[STG].[NewMetric] a where a.[PatientKey] = q.id_Patient and a.[MetricKey] = 3)"," select 3 as metricId, id_Patient, date_YearMonth from  [dbmSemanticAnalytics].[Fact].[BuildingBlocks]  as q
      where BuildingBlockId = 1 and exists (select * from [dbmSemanticAnalyticsSTG].[STG].[NewMetric] a where a.[PatientKey] = q.id_Patient and a.[MetricKey] = 3) intersect  select 3 as metricId, id_Patient, date_YearMonth from  [dbmSemanticAnalytics].[Fact].[BuildingBlocks]  as q
      where BuildingBlockId = 2 and exists (select * from [dbmSemanticAnalyticsSTG].[STG].[NewMetric] a where a.[PatientKey] = q.id_Patient and a.[MetricKey] = 3)"4," select 4 as metricId, id_Patient, date_YearMonth from  [dbmSemanticAnalytics].[Fact].[BuildingBlocks]  where BuildingBlockId = 4 union  select 4 as metricId, id_Patient, date_YearMonth from  [dbmSemanticAnalytics].[Fact].[BuildingBlocks]  where BuildingBlockId = 2 union  select 4 as metricId, id_Patient, date_YearMonth from  [dbmSemanticAnalytics].[Fact].[BuildingBlocks]  where BuildingBlockId = 3 union  select 4 as metricId, id_Patient, date_YearMonth from  [dbmSemanticAnalytics].[Fact].[BuildingBlocks]  where BuildingBlockId = 1"," select 4 as metricId, id_Patient, date_YearMonth from  [dbmSemanticAnalytics].[Fact].[BuildingBlocks]  where BuildingBlockId = 4"," select 4 as metricId, id_Patient, date_YearMonth from  [dbmSemanticAnalytics].[Fact].[BuildingBlocks]  as q
      where BuildingBlockId = 4 and exists (select * from [dbmSemanticAnalyticsSTG].[STG].[NewMetric] a where a.[PatientKey] = q.id_Patient and a.[MetricKey] = 4) union  select 4 as metricId, id_Patient, date_YearMonth from  [dbmSemanticAnalytics].[Fact].[BuildingBlocks]  as q
      where BuildingBlockId = 2 and exists (select * from [dbmSemanticAnalyticsSTG].[STG].[NewMetric] a where a.[PatientKey] = q.id_Patient and a.[MetricKey] = 4) union  select 4 as metricId, id_Patient, date_YearMonth from  [dbmSemanticAnalytics].[Fact].[BuildingBlocks]  as q
      where BuildingBlockId = 3 and exists (select * from [dbmSemanticAnalyticsSTG].[STG].[NewMetric] a where a.[PatientKey] = q.id_Patient and a.[MetricKey] = 4) union  select 4 as metricId, id_Patient, date_YearMonth from  [dbmSemanticAnalytics].[Fact].[BuildingBlocks]  as q
      where BuildingBlockId = 1 and exists (select * from [dbmSemanticAnalyticsSTG].[STG].[NewMetric] a where a.[PatientKey] = q.id_Patient and a.[MetricKey] = 4)"," select 4 as metricId, id_Patient, date_YearMonth from  [dbmSemanticAnalytics].[Fact].[BuildingBlocks]  as q
      where BuildingBlockId = 4 and exists (select * from [dbmSemanticAnalyticsSTG].[STG].[NewMetric] a where a.[PatientKey] = q.id_Patient and a.[MetricKey] = 4)"
