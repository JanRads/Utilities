	USE [dbmSemanticAnalyticsSTG]
GO

create table #T1
(      
  [Id_Program][int] not null,
	[Program_name] [nvarchar](128) not NULL,
) 

---------------------------------------------------------------------------------------------
--Insert Values into the temp Table Patient Root and Patient Extension
---------------------------------------------------------------------------------------------
INSERT INTO #T1(Id_Program,[Program_name])
values
 (1,'Clalit')
,(2,'Maccabi')
,(3,'Meuhedet')
,(4,'Leumi')
,(5,'Arael')
,(-1,'UNKNOWN')



---------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------
declare @P Program
insert into @P 
select  [Id_Program],
	[Program_name]
from #T1

EXEC  Mirror.Program_ins @p
drop table #T1



USE [dbmSemanticAnalyticsSTG]
GO

create table #T1
(   	[Id_patient_Extension] [nvarchar](255)not NULL,
	[Id_patient_Root] [nvarchar](128) not NULL,
	[Id_Program][int] not null,
	[From_Date] [datetime]not NULL,
	[To_Date] [datetime] NULL,
	[DeleteKey] [int] NULL,
	[Id_ProductLine] int NULL
) 

---------------------------------------------------------------------------------------------
--Insert Values into the temp Table Patient Root and Patient Extension
---------------------------------------------------------------------------------------------
INSERT INTO #T1(
[Id_patient_Extension],
	[Id_patient_Root] ,
	[Id_Program],
	[From_Date] ,
	[To_Date],
	[DeleteKey] ,
	[Id_ProductLine]
)
values
--('PHA_EncAT_P22','2.16.840.1.113883.3.57.1.3.5.52.1.8.6',4,'2013-01-01',null,null,null),
--('PHA_EncAT_P1','2.16.840.1.113883.3.57.1.3.5.52.1.8.6',1,'2014-01-01','2014-11-30',null,null),
--('PHA_EncAT_P1','2.16.840.1.113883.3.57.1.3.5.52.1.8.6',2,'2015-01-01','2015-12-31',null,null),
--('PHA_EncAT_P1','2.16.840.1.113883.3.57.1.3.5.52.1.8.6',3,'2016-01-01','2016-12-31',null,null),
--('PHA_Relat_EncAT_P2','2.16.840.1.113883.3.57.1.3.5.52.1.8.6',2,'2016-01-01','2016-12-31',null,null),
--('PHA_Relat_EncAT_P4','2.16.840.1.113883.3.57.1.3.5.52.1.8.6',4,'2015-01-01','2015-12-31',null,null),
--('PHA_Relat_EncAT_P4','2.16.840.1.113883.3.57.1.3.5.52.1.8.6',2,'2015-06-01','2016-05-31',null,null),
--('PHA_Relat_EncAT_P4','2.16.840.1.113883.3.57.1.3.5.52.1.8.6',3,'2015-11-01','2016-02-29',null,null),
--('PHA_Relat_EncAT_P3','2.16.840.1.113883.3.57.1.3.5.52.1.8.6',1,'2014-01-01','2016-12-31',null,null),
--('PHA_Relat_EncAT_P3','2.16.840.1.113883.3.57.1.3.5.52.1.8.6',1,'2015-01-01','2016-12-31',null,null),
--('PHA_EncAT_P3','2.16.840.1.113883.3.57.1.3.5.52.1.8.6',1,'2015-01-01','2015-12-31',null,null),
--('PHA_EncAT_P3','2.16.840.1.113883.3.57.1.3.5.52.1.8.6',4,'2016-01-01','2017-12-31',null,null),
--('PHA25_MCC_P2','2.16.840.1.113883.3.57.1.3.5.52.1.8.6',1,'2016-01-01','2016-12-31',null,null),
--('PHA25_MCC_P2_2d','2.16.840.1.113883.3.57.1.3.5.52.1.8.6',-1,'2016-01-01','2016-12-31',null,null),
--('PHA25_MCC_P3','2.16.840.1.113883.3.57.1.3.5.52.1.8.6',2,'2014-01-01','2015-05-31',null,null),
--('PHA25_MCC_P3','2.16.840.1.113883.3.57.1.3.5.52.1.8.6',3,'2015-01-01','2017-12-31',null,null),
--('PHA25_MCC_P3_2d','2.16.840.1.113883.3.57.1.3.5.52.1.8.6',1,'2015-01-01','2015-12-31',null,null),
--('PHA25_MCC_P3_2d','2.16.840.1.113883.3.57.1.3.5.52.1.8.6',2,'2015-06-01','2015-12-31',null,null),
--('PHA25_MCC_P3_2d','2.16.840.1.113883.3.57.1.3.5.52.1.8.6',3,'2016-01-01','2017-05-31',null,null),
--('PHA25_MCC_P3_2d','2.16.840.1.113883.3.57.1.3.5.52.1.8.6',4,'2016-03-01','2016-10-31',null,null)


--Adding more periods per patient. (Ela)

('PHA_EncAT_P22','2.16.840.1.113883.3.57.1.3.5.52.1.8.6',2,'2010-01-01','2010-11-01',null,1),
('PHA_EncAT_P22','2.16.840.1.113883.3.57.1.3.5.52.1.8.6',4,'2011-01-01','2011-11-01',null,2),
('PHA_EncAT_P22','2.16.840.1.113883.3.57.1.3.5.52.1.8.6',4,'2012-06-01','2013-04-01',null,3),
('PHA_EncAT_P22','2.16.840.1.113883.3.57.1.3.5.52.1.8.6',4,'2014-01-01','2015-06-01',null,1),
('PHA_EncAT_P22','2.16.840.1.113883.3.57.1.3.5.52.1.8.6',4,'2012-01-01','2013-01-01',null,2),
('PHA_EncAT_P1','2.16.840.1.113883.3.57.1.3.5.52.1.8.6',1,'2014-01-01','2014-11-30',null,1),
('PHA_EncAT_P1','2.16.840.1.113883.3.57.1.3.5.52.1.8.6',2,'2015-01-01','2015-12-31',null,2),
('PHA_EncAT_P1','2.16.840.1.113883.3.57.1.3.5.52.1.8.6',3,'2016-01-01','2016-12-31',null,3),
('PHA_Relat_EncAT_P2','2.16.840.1.113883.3.57.1.3.5.52.1.8.6',2,'2016-01-01','2016-12-31',null,1),
('PHA_Relat_EncAT_P4','2.16.840.1.113883.3.57.1.3.5.52.1.8.6',4,'2015-01-01','2015-12-31',null,1),
('PHA_Relat_EncAT_P4','2.16.840.1.113883.3.57.1.3.5.52.1.8.6',2,'2015-06-01','2016-05-31',null,2),
('PHA_Relat_EncAT_P4','2.16.840.1.113883.3.57.1.3.5.52.1.8.6',3,'2015-11-01','2016-02-29',null,3),
('PHA_Relat_EncAT_P3','2.16.840.1.113883.3.57.1.3.5.52.1.8.6',1,'2014-01-01','2016-12-31',null,1),
('PHA_Relat_EncAT_P3','2.16.840.1.113883.3.57.1.3.5.52.1.8.6',1,'2015-01-01','2016-12-31',null,2),
('PHA_EncAT_P3','2.16.840.1.113883.3.57.1.3.5.52.1.8.6',1,'2015-01-01','2015-12-31',null,1),
('PHA_EncAT_P3','2.16.840.1.113883.3.57.1.3.5.52.1.8.6',4,'2016-01-01','2017-12-31',null,2),
('PHA25_MCC_P2','2.16.840.1.113883.3.57.1.3.5.52.1.8.6',1,'2015-01-01','2015-07-29',null,1),
('PHA25_MCC_P2','2.16.840.1.113883.3.57.1.3.5.52.1.8.6',1,'2015-03-01','2016-05-29',null,2),
('PHA25_MCC_P2','2.16.840.1.113883.3.57.1.3.5.52.1.8.6',1,'2016-01-01','2016-12-31',null,3),
('PHA25_MCC_P2_2d','2.16.840.1.113883.3.57.1.3.5.52.1.8.6',-1,'2014-01-01','2014-12-31',null,1),
('PHA25_MCC_P2_2d','2.16.840.1.113883.3.57.1.3.5.52.1.8.6',-1,'2016-01-01','2016-12-31',null,2),
('PHA25_MCC_P3','2.16.840.1.113883.3.57.1.3.5.52.1.8.6',2,'2011-01-01','2011-05-31',null,1),
('PHA25_MCC_P3','2.16.840.1.113883.3.57.1.3.5.52.1.8.6',2,'2012-01-01','2015-03-31',null,2),
('PHA25_MCC_P3','2.16.840.1.113883.3.57.1.3.5.52.1.8.6',2,'2014-01-01','2015-05-31',null,3),
('PHA25_MCC_P3','2.16.840.1.113883.3.57.1.3.5.52.1.8.6',3,'2016-01-01','2017-12-31',null,1),
('PHA25_MCC_P3_2d','2.16.840.1.113883.3.57.1.3.5.52.1.8.6',1,'2015-01-01','2015-12-31',null,1),
('PHA25_MCC_P3_2d','2.16.840.1.113883.3.57.1.3.5.52.1.8.6',2,'2015-06-01','2015-12-31',null,2),
('PHA25_MCC_P3_2d','2.16.840.1.113883.3.57.1.3.5.52.1.8.6',3,'2016-01-01','2017-05-31',null,3),
('PHA25_MCC_P3_2d','2.16.840.1.113883.3.57.1.3.5.52.1.8.6',4,'2016-03-01','2016-10-31',null,1)




---------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------
declare @P Program_Services
insert into @P 
select  [Id_patient_Extension],
	[Id_patient_Root] ,
	[Id_Program],
	[Id_ProductLine],
	[From_Date] ,
	[To_Date],
	[DeleteKey]
from #T1

EXEC  Mirror.Program_Services_ins @p
drop table #T1
